<script type="text/javascript">
    if (sessionStorage.getItem('securityContext') == null) {
        window.location.href = "/APPLETPC/login.html";
    }
    var securityContext = JSON.parse(sessionStorage.getItem('securityContext'));
    var path = sessionStorage.getItem('path');
</script>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>酷特智能Applet管理系统</title>
    <!-- Styles -->
    <link href="/APPLETPC/js/plugins/assets/css/lib/font-awesome.min.css" rel="stylesheet">
    <link href="/APPLETPC/js/plugins/assets/css/lib/themify-icons.css" rel="stylesheet">
    <link href="/APPLETPC/js/plugins/assets/css/lib/menubar/sidebar.css" rel="stylesheet">
    <link href="/APPLETPC/js/plugins/assets/css/lib/bootstrap.min.css" rel="stylesheet">
    <link href="/APPLETPC/js/plugins/assets/css/style.css" rel="stylesheet">
    <script src="/APPLETPC/js/jquery/jquery-3.4.1.min.js"></script>
</head>

<body>

<div class="sidebar sidebar-hide-to-small sidebar-shrink sidebar-gestures">
    <div class="nano">
        <div class="nano-content">
            <ul>
                <div class="logo"><a href="index.html"><span>Applet</span></a></div>

                <li class="label" id="sidebarMenu">欢迎使用Applet管理系统</li>
            </ul>
        </div>
    </div>
</div>
<!-- /# sidebar -->

<div class="header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <div class="float-left">
                    <div class="hamburger sidebar-toggle">
                        <span class="line"></span>
                        <span class="line"></span>
                        <span class="line"></span>
                    </div>
                </div>
                <div class="float-right" style="display: block">
                    <div class="dropdown dib" onclick="showSubMenu(this)">
                        <div class="header-icon" data-toggle="dropdown">
                            <i class="ti-bell"></i>
                            <div class="drop-down dropdown-menu dropdown-menu-right  submenu" style="position: absolute; transform: translate3d(-124px, 51px, 0px); top: 0px; left: 0px; will-change: transform;">
                                <div class="dropdown-content-heading">
                                    <span class="text-left">Recent Notifications</span>
                                </div>
                                <div class="dropdown-content-body">
                                    <ul>
                                        <li>
                                            <a href="#">
                                                <img class="pull-left m-r-10 avatar-img"
                                                     src="/APPLETPC/js/plugins/assets/images/avatar/3.jpg" alt=""/>
                                                <div class="notification-content">
                                                    <small class="notification-timestamp pull-right">02:34 PM</small>
                                                    <div class="notification-heading">Mr. John</div>
                                                    <div class="notification-text">5 members joined today</div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <img class="pull-left m-r-10 avatar-img"
                                                     src="/APPLETPC/js/plugins/assets/images/avatar/3.jpg" alt=""/>
                                                <div class="notification-content">
                                                    <small class="notification-timestamp pull-right">02:34 PM</small>
                                                    <div class="notification-heading">Mariam</div>
                                                    <div class="notification-text">likes a photo of you</div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <img class="pull-left m-r-10 avatar-img"
                                                     src="/APPLETPC/js/plugins/assets/images/avatar/3.jpg" alt=""/>
                                                <div class="notification-content">
                                                    <small class="notification-timestamp pull-right">02:34 PM</small>
                                                    <div class="notification-heading">Tasnim</div>
                                                    <div class="notification-text">Hi Teddy, Just wanted to let you
                                                        ...
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <img class="pull-left m-r-10 avatar-img"
                                                     src="/APPLETPC/js/plugins/assets/images/avatar/3.jpg" alt=""/>
                                                <div class="notification-content">
                                                    <small class="notification-timestamp pull-right">02:34 PM</small>
                                                    <div class="notification-heading">Mr. John</div>
                                                    <div class="notification-text">Hi Teddy, Just wanted to let you
                                                        ...
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li class="text-center">
                                            <a href="#" class="more-link">See All</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown dib" onclick="showSubMenu(this)">
                        <div class="header-icon" data-toggle="dropdown">
                            <i class="ti-email"></i>
                            <div class="drop-down dropdown-menu dropdown-menu-right   submenu" style="position: absolute; transform: translate3d(-124px, 51px, 0px); top: 0px; left: 0px; will-change: transform;">
                                <div class="dropdown-content-heading">
                                    <span class="text-left">2 New Messages</span>
                                    <a href="email.html">
                                        <i class="ti-pencil-alt pull-right"></i>
                                    </a>
                                </div>
                                <div class="dropdown-content-body">
                                    <ul>
                                        <li class="notification-unread">
                                            <a href="#">
                                                <img class="pull-left m-r-10 avatar-img"
                                                     src="/APPLETPC/js/plugins/assets/images/avatar/1.jpg" alt=""/>
                                                <div class="notification-content">
                                                    <small class="notification-timestamp pull-right">02:34 PM</small>
                                                    <div class="notification-heading">Michael Qin</div>
                                                    <div class="notification-text">Hi Teddy, Just wanted to let you
                                                        ...
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li class="notification-unread">
                                            <a href="#">
                                                <img class="pull-left m-r-10 avatar-img"
                                                     src="/APPLETPC/js/plugins/assets/images/avatar/2.jpg" alt=""/>
                                                <div class="notification-content">
                                                    <small class="notification-timestamp pull-right">02:34 PM</small>
                                                    <div class="notification-heading">Mr. John</div>
                                                    <div class="notification-text">Hi Teddy, Just wanted to let you
                                                        ...
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <img class="pull-left m-r-10 avatar-img"
                                                     src="/APPLETPC/js/plugins/assets/images/avatar/3.jpg" alt=""/>
                                                <div class="notification-content">
                                                    <small class="notification-timestamp pull-right">02:34 PM</small>
                                                    <div class="notification-heading">Michael Qin</div>
                                                    <div class="notification-text">Hi Teddy, Just wanted to let you
                                                        ...
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <img class="pull-left m-r-10 avatar-img"
                                                     src="/APPLETPC/js/plugins/assets/images/avatar/2.jpg" alt=""/>
                                                <div class="notification-content">
                                                    <small class="notification-timestamp pull-right">02:34 PM</small>
                                                    <div class="notification-heading">Mr. John</div>
                                                    <div class="notification-text">Hi Teddy, Just wanted to let you
                                                        ...
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li class="text-center">
                                            <a href="#" class="more-link">See All</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown dib" onclick="showSubMenu(this)">
                         <div class="header-icon" data-toggle="dropdown">
                            <span class="user-avatar">王斌
                          <i class="ti-angle-down f-s-10"></i>
                             </span>
                            <div class="drop-down dropdown-profile dropdown-menu dropdown-menu-right submenu"
                                 style="position: absolute; transform: translate3d(-124px, 51px, 0px); top: 0px; left: 0px; will-change: transform;">
                                <div class="dropdown-content-heading">
                                    <span class="text-left">王斌</span>
                                </div>
                                <div class="dropdown-content-body">
                                    <ul>
                                        <li>
                                            <a href="#">
                                                <i class="ti-user"></i>
                                                <span>个人信息</span>
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="ti-settings"></i>
                                                <span>设置</span>
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#" onclick="logout();">
                                                <i class="ti-power-off"></i>
                                                <span>安全退出</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="content-wrap">
    <div class="main">
        <iframe id="homeFrame" style="border: 0;" name="homeFrame" class="iframeClass"
                src="/APPLETPC/html/modules/security/mainMenu.html"
                onload="this.height=$(document).height() - 80" width="100%"></iframe>
    </div>
</div>


<script type="text/javascript">
    var menuTreeHtml = '';
    $(document).ready(function () {
        // 初始化菜单
        revealTreeMenu();
    });

    function revealTreeMenu() {
        var menuTreeJson = JSON.parse(localStorage.getItem('menuTreeJson') != null ? localStorage.getItem('menuTreeJson') : initTreeMenu());
        // var menuTreeJson=initTreeMenu();
        $.each(
            menuTreeJson,
            function (index, data) {
                if (data.data.isLeafNode == "Y") {
                    menuTreeHtml += '    <li><a href="javascript:openPath(\''+data.data.nodeUrl+'\')"><i class="' + data.data.nodeIcon + '"></i> ' + data.data.nodeName + ' </a></li>';
                } else {
                    menuTreeHtml += '	<li><a class="sidebar-sub-toggle"><i class="' + data.data.nodeIcon + '"></i>  ' + data.data.nodeName + '  <span class="sidebar-collapse-icon ti-angle-down"></span></a>';
                    menuTreeHtml += '	<ul>';
                    generateMenuTree(data);
                    menuTreeHtml += '	</ul>';
                    menuTreeHtml += '	</li>';
                }
            });

        $("#sidebarMenu").after(menuTreeHtml);

    }

    // 递归生成子菜单树
    function generateMenuTree(treeData) {
        $.each(treeData.nodes,
            function (index, data) {
                if (data.data.isLeafNode == "Y") {
                    menuTreeHtml += '	<li><a href="javascript:openPath(\'' + data.data.nodeUrl + '\')"><i class="' + data.data.nodeIcon + '"></i> ' + data.data.nodeName + ' </a></li>';
                } else {
                    menuTreeHtml += '	<li><a class="sidebar-sub-toggle"><i class="' + data.data.nodeIcon + '"></i>  ' + data.data.nodeName + '   <span class="sidebar-collapse-icon ti-angle-down"></span>';
                    menuTreeHtml += '    <ul>';
                    generateMenuTree(data);
                    menuTreeHtml += '    </ul>';
                    menuTreeHtml += '    </li>';


                }
            });
    }

    // 初始化树菜单
    function initTreeMenu() {
        var menuTreeJson;
        var url = path + "app/getMenuTree";
        url += "?t=" + new Date();
        $.ajax({
            type: "POST",
            url: url,
            async: false,
            headers: {
                Authorization: securityContext.Authorization

            },
            data: {
                username: securityContext.username
            },
            success: function (data) {
                if (data.code == "S") {
                    localStorage.setItem('menuTreeJson', data.data);
                    menuTreeJson = data.data;

                }
            }
        });
        return menuTreeJson;
    }

    //跳转地址
    function openPath(url) {
        $('#homeFrame').attr('src', url);
    }

</script>

<!-- jquery vendor -->
<script src="/APPLETPC/js/plugins/assets/js/lib/jquery.nanoscroller.min.js"></script>
<!-- nano scroller -->
<script src="/APPLETPC/js/plugins/assets/js/lib/menubar/sidebar.js"></script>
<script src="/APPLETPC/js/plugins/assets/js/lib/preloader/pace.min.js"></script>
<!-- sidebar -->

<!-- bootstrap -->

</body>

</html>
<script>
$(function () {
})
    function showSubMenu(obj){
        if($(obj).find(".submenu").is(":hidden")){　　//如果node是隐藏的则显示node元素，否则隐藏
            $(".submenu").hide();
            $(obj).find(".submenu").show();
        }else{
            $(obj).find(".submenu").hide();
        }

    }
//注销
function logout() {

    localStorage.clear();
    sessionStorage.clear();
    window.location.href = "/APPLETPC/login.html";
}

</script>